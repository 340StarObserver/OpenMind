## 软件需求 ##

// 细化出的各种模块和对应的要求  

// 注明移动端的表示只有在移动端才会有  

// 注明网页端的表示只有在网页端才会有  

// 没有注明的表示在移动端和网页端都会有  


### 01. 本地数据库的封装（移动端） ###

            封装了数据库的名称，各表的表名，数据库的版本等基本信息  
            
            每当创建连接的时候，检查数据库和各表是否已经被创建，若无则自动创建  
            
            只在打开APP的时候创建连接，之后重用这个连接，而不是每次都创建新的连接  
            
            静态单例对象，且在打开APP的时候自动生成这个对象  
            
            能接受个人信息对象/项目对象/其他等等对象，把数据持久化(insert/update)到本地数据库  
            
            能从本地数据库中查出各种东西  
            
            做CURD操作的时候，需要在这个单例对象内部加入同步控制(因为可能不同线程同时去用它)  


### 02. 网络配置的封装（移动端） ###

            包含属性 ： 服务器ip，服务器port，本次的SessionId，持有的令牌token  
            
            静态单例对象  
            
            在第一次用这个对象的时候创建，通过该类的静态函数getInstance来封装  
            
            ip和port只定义一次，且写死  
            
            SessionId和token一开始是空的，在登陆成功后，从响应头里获取SessionId，从响应体里获取token  
            
            之后用户发起需要登陆才能干的事情的时候，需要在请求头里带上SessionId  
            
            之后用户发起敏感操作的时候，需要在请求体里带上token，且操作成功后需要从响应体里获取新的token  


### 03. 个人信息的封装（移动端） ###

            包含属性 ： 用户名，密码密文，名字，院系，注册时间，头像地址（本地磁盘）  
            
            其中，注册时间形如"2016-08-11"  
            
            其中，剩余投票次数一开始默认是0  
            
            静态单例对象  
            
            本地数据库中有对应的表  
            
            在第一次登陆成功后（准确说是在本地数据库里没有数据的时候），需要更新这个对象，并持久化到本地数据库  
            
            以后打开APP是自动登陆的，它会先读本地数据库，然后创建出这个单例对象，并自动发起登陆请求  


### 04. 个人信息的封装（网页端） ###

            包含属性 ： 用户名，名字，院系，注册时间，头像地址（url），令牌token  
            
            其中，注册时间形如"2016-08-11"  
                        
            其中，剩余投票次数一开始默认是0  
            
            文件全局对象  
            
            在登陆成功后，创建这个对象  
            
            在进行页面切换的时候，通过cookie进行中转暂存  


### 05. 个人项目数据的封装（移动端） ###

            包含属性 ： 形式上形如 docs/design/data_design.md 中的 项目数据project_info  
            
            本地数据库中有对应的表  
            
            能够持久化(insert/update)到本地数据库  
            
            能够通过项目的id，从本地数据库中读出某个项目的详细信息，并创建一个相应的这个对象  
            
            能够以分页的方式(按时间降序分页)，从本地数据库中查出多个项目的概要信息  


### 06. 个人活跃数据的封装（移动端） ###

            包含属性 ： 形式上如 docs/design/data_design.md 中的 个人活跃数据active_info  
            
            本地数据库中有对应的表  
            
            能够持久化(insert/update)到本地数据库  
            
            能够从本地数据库查出某人某年某月的活跃记录  


### 07. 创建一个用户 ###

            所需数据 ： 用户名，密码密文，真实姓名，院系，头像图片  
            
            客户端检查数据的完整性和有效性，并以很优雅的方式提示  
            
            服务端需要能够抵御数据库攻击  
            
            服务端需要能够抵御文件上传攻击  
            
            客户端在接收到表示成功的响应后，要自动发起登陆请求  


### 08. 登陆认证 ###

            所需数据 ： 用户名，密码密文  
            
            客户端检查数据的完整性和有效性，并以很优雅的方式提示  
            
            服务端需要能够抵御数据库攻击  
            
            服务端单核2G环境能每秒处理100次业务  
            
            返回数据 ： 真实姓名，院系，注册时间，头像地址url，令牌token  

            若是移动端 :  

                客户端需要把返回的数据(除了令牌token)，连同用户名和密码密文，记录到个人信息的单例对象中  
                
                客户端需要把令牌token，和响应头里的SessionId，记录到网络配置的单例对象中  

            若移动端是第一次登陆(可在本地数据库中设一状态表，该表只一条记录，表示是否第一次登陆)，则还需要 :  

                把个人信息单例对象中的数据持久化到本地数据库中，并根据头像的链接来下载图片存到本地磁盘  
                
                紧接着，发起加载数据的请求，从服务端拉取个人项目数据 + 个人活跃数据，并把它们都持久化到本地数据库  
                
                以后启动APP的时候从本地数据库中拿出用户名和密码密文，发起自动登陆  

            若是网页端 :  

                客户端需要把返回的数据，连同用户名，记录到个人信息的对象中  


### 09. 清空本地个人数据（移动端） ###

            客户端在进行注销的时候，可以选择清空个人本地数据  
            
            把本地数据库中的所有表都清空，且状态表还原成第一次登陆的状态  


### 10. 新增一个项目（网页端） ###

            所需数据 ： 项目名称，标签们，可选链接（多个），项目简介，可附带多个文件，令牌token(用于认证)  
            
            其中，项目名称和项目简介不可为空  
            
            其中，标签们逻辑上默认是空的列表，可选链接默认是空  
            
            客户端检查各信息的有效性，并以很优雅的方式提示  
            
            客户端对文件类型不做限制，但限制文件大小上限是16M  

            客户端在提交请求后，接收到响应前，以动画形式做过渡  
            
            客户端在收到表示成功的响应后，需要把响应体里的新token记录下来  
            
            服务端单核2G环境能每秒处理30次业务  
            
            服务端能够防止文件上传攻击  


### 11. 分享新的收获（网页端） ###

            客户端可同时上传多个文件的分享  
            
            客户端对文件类型不做限制，但限制文件大小上限是16M  
            
            客户端在提交请求后，接收到响应前，以动画形式做过渡  
            
            客户端在收到表示成功的响应后，需要把响应体里的新token记录下来  

            服务端单核2G环境能每秒处理30次业务  
            
            服务端能够防止文件上传攻击


### 12. 浏览所有项目的概要信息 ###

            不需要登陆，就能做这件事  
            
            以分页的方式(按照时间降序分页)，从服务端拿若干项目的概要信息  
            
            对于每个项目，获取 :  

                项目id（不展示），项目名称，发起人用户名，发起人姓名，发起人头像链接，发起时间，标签们，项目简介  

            客户端下拉自动获取下一页的数据  
            
            客户端若是移动端，则使用H5，以适配各机型  
            
            服务端单核2G环境能每秒处理100次业务  


### 13. 浏览自己的所有项目的概要信息 ###

            若是移动端 :  
            
                不需要登陆，且从本地数据库中拿东西，不向服务端发请求  
                
                且使用H5，以适配各机型  
            
            若是网页端 :  
            
                需要登陆，且向服务端发请求来获取自己所有项目的概要信息  
            
            对于每个项目，获取 :  
            
                项目id（不展示），项目名称，发起人用户名，发起人姓名，发起人头像链接，发起时间，标签们，项目简介  


### 14. 浏览具体的一个项目的详细信息 ###

            不需要登陆，就能做这件事  
            
            展示除了项目id之外的所有数据  
            
            客户端若是移动端，则使用H5，以适配各机型  
            
            服务端单核2G环境能每秒处理100次业务  


### 15. 浏览具体的一个项目中的某个分享文档的信息 ###

            不需要登陆，就能做这件事  
            
            客户端若是移动端，则使用H5，以适配各机型  
            
            能够较好地支持显示 :  

                jpg, png  
                
                pdf  
                
                txt, cpp, py 等这些可以一视同仁的代码文件  
                
                md  


### 16. 同步自己的数据（移动端） ###

            服务端把该用户的项目数据 + 活跃数据，一次性返回给客户端  
            
            客户端首先检查是否已登陆，若无则先登陆  
            
            客户端需要在请求体中带上令牌token  
            
            客户端在接收到响应前，用动画做过渡  
            
            客户端接收到响应后 :  
            
                从响应头中获取新的sessionid，并把它记录到单例的网络配置对象中  

                从响应体中获取新的token，并把它记到单例的网络配置对象中  
                
                从响应体中获取个人项目数据 + 活跃数据，并批量持久化到本地数据库  


### 17. 查看个人活跃记录 ###

            若是移动端 :  
            
                不需要登陆，且从本地数据库中拿东西，不向服务端发请求  
                
                且使用H5，以适配各机型
            
            若是网页端 :  
            
                需要登陆，且向服务端发请求来获取个人活跃数据  
            
            默认是查今年今月，也可以向前向后跳  
            
            客户端绘制表格来生动显示  


### 18. 发表评论 ###

            客户端首先检查是否登陆，若无则先登陆  
            
            所需数据　：　项目id，项目名称，项目所有者的用户名，父评论的id，这条评论的内容  

                若这条评论是针对这个项目的，则父评论的id为"0"  
                
                若这条评论是针对某条评论的，则父评论的id为那条评论的id  

            若是移动端，收到响应后 :  

                更新本地数据库中的个人活跃数据  
                
                检查本地数据库中的个人项目中有没有这个项目(即检查这个项目是否是自己的)，若是，更新项目的评论  


### 19. 查看与我相关的消息 ###

            客户端首先检查是否登陆，若无则先登陆  
            
            客户端对于每条记录，显示谁(他的用户名，姓名，头像)在何时针对哪个项目(项目名称)发表了什么评论  
            
            客户端若是移动端，则使用H5，以适配各机型  
            
            服务端以分页的方式(按时间降序分页)，返回与我相关的若干条消息  
            
            服务端单核2G环境能每秒处理100次业务  


### 20. 查看当前投票栏 ###

            不需要登陆，就能做这件事  
            
            客户端对于处于投票的各项目，需要展示除了项目id以外的所有信息  
            
            客户端若是移动端，则使用H5，以适配各机型  
            
            服务端单核2G环境能每秒处理100次业务  


### 21. 为喜爱的分享投票 ###

            客户端首先检查是否登陆，若无则先登陆  
            
            所需数据　：　项目id  
            
            服务端单核2G环境能每秒处理200次业务  
